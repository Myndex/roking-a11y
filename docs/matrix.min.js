function Color(e,t){function r(){function e(e){return`0${e.toString(16)}`.substr(-2)}if(f(this.red)&&f(this.green)&&f(this.blue))return this.opacity<1?`#${e(this.red)}${e(this.green)}${e(this.blue)}${e(Math.floor(255*this.opacity))}`:`#${e(this.red)}${e(this.green)}${e(this.blue)}`}function n(e){var t=e.value||e.hcolor||e;return N.hex.map(function(e){var r=e.exec(""+t.trim());if(r)return{red:Math.min(255,Math.max(0,h((r[1]+r[1]).substr(-2)))),green:Math.min(255,Math.max(0,h((r[2]+r[2]).substr(-2)))),blue:Math.min(255,Math.max(0,h((r[3]+r[3]).substr(-2)))),opacity:r[4]?Math.min(1,Math.max(0,h((r[4]+r[4]).substr(-2))/255)):1}}).reduce(function(e,t){return e||t})}function i(e){var t,r,n,i,u;return s(e)&&(e=function(e){return N.hsl.map(function(t){var r=t.exec(e);if(r)return{hue:Number(r[1]),saturation:b(r[2]),lightness:b(r[3]),opacity:r[4]?Number(r[4]):1}}).reduce(function(e,t){return e||t})}(e)),0===e.saturation?{red:255*e.lightness,green:255*e.lightness,blue:255*e.lightness,opacity:e.opacity}:"number"==typeof e.hue&&"number"==typeof e.saturation&&"number"==typeof e.lightness?(t=(1-Math.abs(2*e.lightness-1))*e.saturation,r=e.hue/60,n=t*(1-Math.abs(r%2-1)),i=e.lightness-t/2,u=[[t,n,0],[n,t,0],[0,t,n],[0,n,t],[n,0,t],[t,0,n]][Math.floor(r)%6],{red:Math.round(255*(u[0]+i)),green:Math.round(255*(u[1]+i)),blue:Math.round(255*(u[2]+i)),opacity:e.opacity}):void 0}function u(e){return N.rgb.map(function(t){var r=t.exec(e);if(r)return{red:Number(r[1]),green:Number(r[2]),blue:Number(r[3]),opacity:r[4]?Number(r[4]):1}}).reduce(function(e,t){return e||t})}function o(e){var t,r,n,i,o,a,s,c=60;if(l(e)&&(e=u(e)),e&&f(e.red)&&f(e.green)&&f(e.blue))return t=d(e.red/255),r=d(e.green/255),n=d(e.blue/255),a=((i=Math.max(t,r,n))+(o=Math.min(t,r,n)))/2,s=i===o?0:a<.5?(i-o)/(i+o):(i-o)/(2-i-o||1),c*=t===i?(r-n)/(i-o||1):r===i?2+(n-t)/(i-o||1):4+(t-r)/(i-o||1),c+=c<0?360:0,{hue:Math.round(c),saturation:Math.round(100*s)/100,lightness:Math.round(100*a)/100,opacity:e.opacity}}function a(e){return s(e)||e&&f(e.hue)&&f(e.saturation)&&f(e.lightness)}function s(e){return N.hsl.map(function(t){return t.test(e)}).filter(function(e){return e}).length>0}function c(e){return e&&f(e.red)&&f(e.green)&&f(e.blue)}function l(e){return N.rgb.map(function(t){return t.test(e)}).filter(function(e){return e}).length>0}function f(e){return!Number.isNaN(e)&&void 0!==e}function h(e){return parseInt(e,16)}function d(e){return Number(e.toFixed(2))}function b(e){if("string"==typeof e||"number"==typeof e)return/%$/.test(e)?parseFloat(e.replace(/%$/,""))/100:/^[0a-f]+$/i.test(e)?parseInt(e,16):parseFloat(e)}Object.defineProperty(this,"blue",{enumerable:!0,get:function(){return m},set:function(e){m="string"==typeof e&&/[a-f]/i.test(e)?b(e):Number(e);var t=o({red:g,green:p,blue:m});t&&(y=t.hue,M=t.saturation,v=t.lightness)},writeable:!0}),Object.defineProperty(this,"brightness",{enumerable:!0,get:function(){if(f(g)&&f(p)&&f(m)){var e=[P.red,P.green,P.blue];return[g,p,m].map(function(t,r){return e[r]*Math.pow(t/255,2.4)}).reduce(function(e,t){return e+=t},0)}}}),Object.defineProperty(this,"canDarken",{enumerable:!0,get:function(){return this.luminance>0}}),Object.defineProperty(this,"canLighten",{enumerable:!0,get:function(){return this.luminance<100}}),Object.defineProperty(this,"green",{enumerable:!0,get:function(){return p},set:function(e){p="string"==typeof e&&/[a-f]/i.test(e)?b(e):Number(e);var t=o({red:g,green:p,blue:m});t&&(y=t.hue,M=t.saturation,v=t.lightness)},writeable:!0}),Object.defineProperty(this,"hcolor",{enumerable:!0,get:r,set:function(e){var t=n(e),r=o(t);f(t.red)&&f(t.green)&&f(t.blue)&&(g=t.red,p=t.green,m=t.blue,j=t.opacity);f(r.hue)&&f(r.saturation)&&f(r.lightness)&&(y=r.hue,M=r.saturation,v=r.lightness)},writeable:!0}),Object.defineProperty(this,"hue",{enumerable:!0,get:function(){return y},set:function(e){y=Number(e),y+=y<360?360:0;var t=i({hue:y%=360,saturation:M,lightness:v,opacity:j});t&&(g=t.red,p=t.green,m=t.blue)},writeable:!0}),Object.defineProperty(this,"lightness",{enumerable:!0,get:function(){if("number"==typeof v)return`${Math.round(100*v)}%`},set:function(e){v="string"==typeof e?b(e):Number(e);var t=i({hue:y,saturation:M,lightness:v,opacity:j});t&&(g=t.red,p=t.green,m=t.blue)},writeable:!0}),Object.defineProperty(this,"LINEAR_MODIFIER",{enumerable:!0,get:function(){return P},set:function(e){f(e.red)&&f(e.green)&&f(e.blue)&&(P=e)},writeable:!0}),Object.defineProperty(this,"luminance",{enumerable:!0,get:function(){function e(e){var t=e/255;return t<.03928?t/12.92:Math.pow((t+.055)/1.055,2.4)}if(f(g)&&f(p)&&f(m))return 100*(P.red*e(g)+P.green*e(p)+P.blue*e(m))}}),Object.defineProperty(this,"name",{enumerable:!0,get:function(){return O||(r()||"").replace(/#/,"")},set:function(e){e&&(O=e)},writeable:!0}),Object.defineProperty(this,"opacity",{enumerable:!0,get:function(){return"number"!=typeof j?1:d(j)},set:function(e){var t;t="string"==typeof e&&/%/.test(e)?Number(e.replace(/%/g,""))/100:"string"==typeof e&&/^0|[a-f]/i.test(e)?parseInt(e,16)/255:Number(e);Number.isNaN(t)||(j=d(Math.floor(t)>0?t/100:t))},writeable:!0}),Object.defineProperty(this,"red",{enumerable:!0,get:function(){return g},set:function(e){g="string"==typeof e&&/[a-f]/i.test(e)?b(e):Number(e);var t=o({red:g,green:p,blue:m});t&&(y=t.hue,M=t.saturation,v=t.lightness)},writeable:!0}),Object.defineProperty(this,"saturation",{enumerable:!0,get:function(){if("number"==typeof M)return`${Math.round(100*M)}%`},set:function(e){M="string"==typeof e?b(e):Number(e);var t=i({hue:y,saturation:M,lightness:v,opacity:j});t&&(g=t.red,p=t.green,m=t.blue)},writeable:!0}),this.darken=function(e){var t=this.toString()||"#000000",r=parseInt(t.replace(/^#/,""),16),i=Math.max(0,(r>>16)-(e||1)),u=(Math.max(0,(255&r)-(e||1))|Math.max(0,(r>>8&255)-(e||1))<<8|i<<16).toString(16),o=n(`000000${u}`.substr(-6)),a=convertRgbTohsl(o);return o&&(g=o.red,p=o.green,m=o.blue),a&&(u=a.hue,M=a.saturation,v=a.lightness),this},this.lighten=function(e){var t=this.toString()||"#ffffff",r=parseInt(t.replace(/^#/,""),16),i=Math.min((r>>16)+(e||1),255),u=(Math.min((255&r)+(e||1),255)|Math.min((r>>8&255)+(e||1),255)<<8|i<<16).toString(16),a=n(`000000${u}`.substr(-6)),s=o(a);return a&&(g=a.red,p=a.green,m=a.blue),s&&(u=s.hue,M=s.saturation,v=s.lightness),this},this.isColorType=function(e){return"string"==typeof e?Object.keys(N).map(function(t){return N[t].map(function(t){return t.test(e)}).filter(function(e){return e}).length>0}).filter(function(e){return e}).length>0:a(e)||c(e)},this.toString=function(){return this.hcolor};var g,p,m,y,M,v,j,C,k,w,P={red:.2126,green:.7152,blue:.0722},N={hex:[/^#?([0-9a-f]{1})([0-9a-f]{1})([0-9a-f]{1})$/i,/^#?([0-9a-f]{2})([0-9a-f]{2})([0-9a-f]{2})([0-9a-f]{2})?$/i,/^#?([0-9a-f]{1})([0-9a-f]{1})([0-9a-f]{1})([0-9a-f]{1})?$/i,/^#?([0-9a-f]{2})([0-9a-f]{2})([0-9a-f]{2})([0-9a-f]{2})?$/i],rgb:[/^rgb\((\d+)\W+(\d+)\W+(\d+)\);?$/i,/^rgba\((\d+)\W+(\d+)\W+(\d+)\W*(\d?\.\d+)?\);?$/i],hsl:[/^hsl\((\d+)\W+(\d+%)\W+(\d+%)\);?$/i,/^hsla?\((\d+)\W+(\d+%)\W+(\d+%)\W*(\d?\.\d+)?\);?$/i]},O=t;k=function(e){if(e)return c(e)?e:l(e)?u(e):a(e)?i(e):n(e)}(C=e),w=o(k),k&&(g=k.red,p=k.green,m=k.blue,j=k.opacity||b(C.opacity)),w&&(y=parseInt(w.hue,10),y+=y<0?360:0,M=b(w.saturation),v=b(w.lightness)),O="object"==typeof C&&(C.name||C.label)||O}function Luminance(e,t){function r(e){return(new Color).isColorType(e)}var n,i,u,o;Object.defineProperty(this,"background",{enumerable:!0,get:function(){return n},set:function(e){n=e instanceof Color?e:new Color(e),u=u||new Color(e)},writeable:!0}),Object.defineProperty(this,"contrast",{enumerable:!0,get:function(){if(i&&n)return function(e,t){var r,n,i;if((new Color).isColorType(e)&&(new Color).isColorType(t))return r=new Color({red:(1-e.opacity)*t.red+e.opacity*e.red,green:(1-e.opacity)*t.green+e.opacity*e.green,blue:(1-e.opacity)*t.blue+e.opacity*e.blue}).luminance+5,n=t.luminance+5,i=r/n,(i=r<n?1/i:i).toFixed(2)}(i,n)}}),Object.defineProperty(this,"foreground",{enumerable:!0,get:function(){return i},set:function(e){i=e instanceof Color?e:new Color(e),o=o||new Color(e)},writeable:!0}),this.reset=function(){return this.foreground=o,this.background=u,this},this.search=function(e,t){var r=this.background,n=this.foreground;if(this.foreground.luminance<this.background.luminance?(this.foreground.adjust=this.foreground.darken,this.foreground.adjustProperty="canDarken",this.background.adjust=this.background.lighten,this.background.adjustProperty="canLighten"):(this.foreground.adjust=this.foreground.lighten,this.foreground.adjustProperty="canLighten",this.background.adjust=this.background.darken,this.background.adjustProperty="canDarken"),t)for(;t[t.adjustProperty]&&!this.test(e);)t.adjust();else for(;(r[r.adjustProperty]||n[n.adjustProperty])&&!this.test(e);)r[r.adjustProperty]&&r.adjust(),n[n.adjustProperty]&&n.adjust();return this},this.test=function(e){return!(this.contrast<e)},e&&e.background?this.background=e.background:r(t)&&(this.background=t),e&&e.foreground?this.foreground=e.foreground:r(e)&&(this.foreground=e)}function Matrix(){var e=[].slice.call(arguments).map(function(e){return/[{}]/.test(e)?JSON.parse("["+e.replace(/#/g,"")+"]"):"string"==typeof e&&e.indexOf(",")?e.split(",").map(function(e){return{name:e,value:e}}):e instanceof Array?e:[e]}).reduce(function(e,t){return t.concat(e)},[]).map(function(e){return e.value&&e.value instanceof Color?e:new Color(e)}).filter(function(e){return"number"==typeof e.hue}).reduce(function(e,t){var r={};return r[t.name]=t,{...e,...r}},{}),t=function(e){var t=Number(String((new Date).getTime()*Math.random()).replace(/\./g,"")).toString(16).substr(-1*e),r=Math.floor(Math.random()*(t.length-e));return t.substr(r,e)},r=[t(8),t(4),t(4),t(4),t(12)].join("-");return Object.keys(e).forEach(function(t){e[t].contrasts=Object.keys(e).filter(function(e){return e!==t}).reduce(function(r,n){var i={};return i[n]=new Luminance(e[t],e[n]),{...r,...i}},{})}),Object.defineProperty(this,"toHtmlTable",{value:function(){var t=document.createElement("div"),n=t.appendChild(document.createElement("style"));n.setAttribute("type","text/css"),n.innerHTML="",n.innerHTML+="#"+r+" .some {background-color:rgb(255,255,157);color:#000;}\n",n.innerHTML+="#"+r+" .fail {background-color:rgb(255,148,141);color:#000;}\n",n.innerHTML+="#"+r+" .pass {background-color:rgb(148,255,141);color:#000;}\n",n.innerHTML+="th[scope='col']>div>span:first-of-type {border:1px solid #000;border-radius:50%;display:inline-block;flex-grow:0;flex-shrink:0;height:0.75em;margin-right:0.25em;width:0.75em;}\n";var i,u=t.appendChild(document.createElement("table")),o=u.appendChild(document.createElement("thead")).insertRow(),a=u.appendChild(document.createElement("tbody")),s=Object.keys(e),c=o.appendChild(document.createElement("td"));return u.setAttribute("id",r),s.forEach(function(t){var r=a.appendChild(document.createElement("tr")),n=e[t].hcolor,u=e[t].name;(c=o.appendChild(document.createElement("th"))).setAttribute("role","columnheader"),c.setAttribute("scope","col"),c.appendChild(function(e,t){var r=document.createElement("div"),n=r.appendChild(document.createElement("span")),i=r.appendChild(document.createElement("span"));return r.style.alignItems="center",r.style.display="flex",r.style.justifyContent="center",n.style.backgroundColor=e,i.setAttribute("title",e),i.innerHTML=t,r}(n,u)),(i=r.appendChild(document.createElement("th"))).setAttribute("role","rowheader"),i.setAttribute("scope","row"),i.innerHTML=u,s.forEach(function(n){var u=e[t].contrasts[n]||{contrast:"-"},o="";u.contrast<3?o="fail":u.contrast<4.5?o="some":"-"!==u.contrast&&(o="pass"),(i=r.appendChild(document.createElement("td"))).innerHTML=u.contrast,i.className=o})}),t}}),this};
