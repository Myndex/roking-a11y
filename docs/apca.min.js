function Color(e){function t(e){return j.hex.map(function(t){var n=t.exec(""+e.trim());if(n)return{red:Math.min(255,Math.max(0,h((n[1]+n[1]).substr(-2)))),green:Math.min(255,Math.max(0,h((n[2]+n[2]).substr(-2)))),blue:Math.min(255,Math.max(0,h((n[3]+n[3]).substr(-2)))),opacity:n[4]?Math.min(1,Math.max(0,h((n[4]+n[4]).substr(-2))/255)):1}}).reduce(function(e,t){return e||t})}function n(e){var t,n,r,u,i;return o(e)&&(e=function(e){return j.hsl.map(function(t){var n=t.exec(e);if(n)return{hue:Number(n[1]),saturation:c(n[2]),lightness:c(n[3]),opacity:n[4]?Number(n[4]):1}}).reduce(function(e,t){return e||t})}(e)),0===e.saturation?{red:255*e.lightness,green:255*e.lightness,blue:255*e.lightness,opacity:e.opacity}:"number"==typeof e.hue&&"number"==typeof e.saturation&&"number"==typeof e.lightness?(t=(1-Math.abs(2*e.lightness-1))*e.saturation,n=e.hue/60,r=t*(1-Math.abs(n%2-1)),u=e.lightness-t/2,i=[[t,r,0],[r,t,0],[0,t,r],[0,r,t],[r,0,t],[t,0,r]][Math.floor(n)%6],{red:Math.round(255*(i[0]+u)),green:Math.round(255*(i[1]+u)),blue:Math.round(255*(i[2]+u)),opacity:e.opacity}):void 0}function r(e){return j.rgb.map(function(t){var n=t.exec(e);if(n)return{red:Number(n[1]),green:Number(n[2]),blue:Number(n[3]),opacity:n[4]?Number(n[4]):1}}).reduce(function(e,t){return e||t})}function u(e){var t,n,u,i,o,a,h,c=60;if(s(e)&&(e=r(e)),l(e.red)&&l(e.green)&&l(e.blue))return t=f(e.red/255),n=f(e.green/255),u=f(e.blue/255),a=((i=Math.max(t,n,u))+(o=Math.min(t,n,u)))/2,h=i===o?0:a<.5?(i-o)/(i+o):(i-o)/(2-i-o||1),c*=t===i?(n-u)/(i-o||1):n===i?2+(u-t)/(i-o||1):4+(t-n)/(i-o||1),c+=c<0?360:0,{hue:Math.round(c),saturation:Math.round(100*h)/100,lightness:Math.round(100*a)/100,opacity:e.opacity}}function i(e){return o(e)||e&&l(e.hue)&&l(e.saturation)&&l(e.lightness)}function o(e){return j.hsl.map(function(t){return t.test(e)}).filter(function(e){return e}).length>0}function a(e){return e&&l(e.red)&&l(e.green)&&l(e.blue)}function s(e){return j.rgb.map(function(t){return t.test(e)}).filter(function(e){return e}).length>0}function l(e){return!Number.isNaN(e)&&void 0!==e}function h(e){return parseInt(e,16)}function f(e){return Number(e.toFixed(2))}function c(e){if("string"==typeof e||"number"==typeof e)return/%$/.test(e)?parseFloat(e.replace(/%$/,""))/100:/^[0a-f]+$/i.test(e)?parseInt(e,16):parseFloat(e)}Object.defineProperty(this,"blue",{enumerable:!0,get:function(){return g},set:function(e){g="string"==typeof e&&/[a-f]/i.test(e)?c(e):Number(e);var t=u({red:b,green:d,blue:g});t&&(p=t.hue,m=t.saturation,y=t.lightness)},writeable:!0}),Object.defineProperty(this,"brightness",{enumerable:!0,get:function(){if(l(b)&&l(d)&&l(g)){var e=[w.red,w.green,w.blue];return[b,d,g].map(function(t,n){return e[n]*Math.pow(t/255,2.4)}).reduce(function(e,t){return e+=t},0)}}}),Object.defineProperty(this,"canDarken",{enumerable:!0,get:function(){return this.luminance>0}}),Object.defineProperty(this,"canLighten",{enumerable:!0,get:function(){return this.luminance<100}}),Object.defineProperty(this,"green",{enumerable:!0,get:function(){return d},set:function(e){d="string"==typeof e&&/[a-f]/i.test(e)?c(e):Number(e);var t=u({red:b,green:d,blue:g});t&&(p=t.hue,m=t.saturation,y=t.lightness)},writeable:!0}),Object.defineProperty(this,"hcolor",{enumerable:!0,get:function(){function e(e){return`0${e.toString(16)}`.substr(-2)}if(l(this.red)&&l(this.green)&&l(this.blue))return this.opacity<1?`#${e(this.red)}${e(this.green)}${e(this.blue)}${e(Math.floor(255*this.opacity))}`:`#${e(this.red)}${e(this.green)}${e(this.blue)}`},set:function(e){var n=t(e),r=u(n);l(n.red)&&l(n.green)&&l(n.blue)&&(b=n.red,d=n.green,g=n.blue,M=n.opacity);l(r.hue)&&l(r.saturation)&&l(r.lightness)&&(p=r.hue,m=r.saturation,y=r.lightness)},writeable:!0}),Object.defineProperty(this,"hue",{enumerable:!0,get:function(){return p},set:function(e){p=Number(e),p+=p<360?360:0;var t=n({hue:p%=360,saturation:m,lightness:y,opacity:M});t&&(b=t.red,d=t.green,g=t.blue)},writeable:!0}),Object.defineProperty(this,"lightness",{enumerable:!0,get:function(){if("number"==typeof y)return`${Math.round(100*y)}%`},set:function(e){y="string"==typeof e?c(e):Number(e);var t=n({hue:p,saturation:m,lightness:y,opacity:M});t&&(b=t.red,d=t.green,g=t.blue)},writeable:!0}),Object.defineProperty(this,"LINEAR_MODIFIER",{enumerable:!0,get:function(){return w},set:function(e){l(e.red)&&l(e.green)&&l(e.blue)&&(w=e)},writeable:!0}),Object.defineProperty(this,"luminance",{enumerable:!0,get:function(){function e(e){var t=e/255;return t<.03928?t/12.92:Math.pow((t+.055)/1.055,2.4)}if(console.log(`r: ${b}, g: ${d}, b: ${g}, ranger: ${e(b)}, rangeg: ${e(d)}, rangeb: ${e(g)}`),l(b)&&l(d)&&l(g))return 100*(w.red*e(b)+w.green*e(d)+w.blue*e(g))}}),Object.defineProperty(this,"opacity",{enumerable:!0,get:function(){return"number"!=typeof M?1:f(M)},set:function(e){var t;t="string"==typeof e&&/%/.test(e)?Number(e.replace(/%/g,""))/100:"string"==typeof e&&/^0|[a-f]/i.test(e)?parseInt(e,16)/255:Number(e);Number.isNaN(t)||(M=f(Math.floor(t)>0?t/100:t))},writeable:!0}),Object.defineProperty(this,"red",{enumerable:!0,get:function(){return b},set:function(e){b="string"==typeof e&&/[a-f]/i.test(e)?c(e):Number(e);var t=u({red:b,green:d,blue:g});t&&(p=t.hue,m=t.saturation,y=t.lightness)},writeable:!0}),Object.defineProperty(this,"saturation",{enumerable:!0,get:function(){if("number"==typeof m)return`${Math.round(100*m)}%`},set:function(e){m="string"==typeof e?c(e):Number(e);var t=n({hue:p,saturation:m,lightness:y,opacity:M});t&&(b=t.red,d=t.green,g=t.blue)},writeable:!0}),this.darken=function(e){var n=this.toString()||"#000000",r=parseInt(n.replace(/^#/,""),16),u=Math.max(0,(r>>16)-(e||1)),i=(Math.max(0,(255&r)-(e||1))|Math.max(0,(r>>8&255)-(e||1))<<8|u<<16).toString(16),o=t(`000000${i}`.substr(-6)),a=convertRgbTohsl(o);return o&&(b=o.red,d=o.green,g=o.blue),a&&(i=a.hue,m=a.saturation,y=a.lightness),this},this.lighten=function(e){var n=this.toString()||"#ffffff",r=parseInt(n.replace(/^#/,""),16),i=Math.min((r>>16)+(e||1),255),o=(Math.min((255&r)+(e||1),255)|Math.min((r>>8&255)+(e||1),255)<<8|i<<16).toString(16),a=t(`000000${o}`.substr(-6)),s=u(a);return a&&(b=a.red,d=a.green,g=a.blue),s&&(o=s.hue,m=s.saturation,y=s.lightness),this},this.isColorType=function(e){return"string"==typeof e?Object.keys(j).map(function(t){return j[t].map(function(t){return t.test(e)}).filter(function(e){return e}).length>0}).filter(function(e){return e}).length>0:i(e)||a(e)},this.toString=function(){return this.hcolor};var b,d,g,p,m,y,M,v,x,$,O,w={red:.2126,green:.7152,blue:.0722},j={hex:[/^#?([0-9a-f]{1})([0-9a-f]{1})([0-9a-f]{1})$/i,/^#?([0-9a-f]{2})([0-9a-f]{2})([0-9a-f]{2})([0-9a-f]{2})?$/i,/^#?([0-9a-f]{1})([0-9a-f]{1})([0-9a-f]{1})([0-9a-f]{1})?$/i,/^#?([0-9a-f]{2})([0-9a-f]{2})([0-9a-f]{2})([0-9a-f]{2})?$/i],rgb:[/^rgb\((\d+)\W+(\d+)\W+(\d+)\);?$/i,/^rgba\((\d+)\W+(\d+)\W+(\d+)\W*(\d?\.\d+)?\);?$/i],hsl:[/^hsl\((\d+)\W+(\d+%)\W+(\d+%)\);?$/i,/^hsla?\((\d+)\W+(\d+%)\W+(\d+%)\W*(\d?\.\d+)?\);?$/i]};$=a(x=v=e)?x:s(x)?r(x):i(x)?n(x):t(x),O=u($),$&&(b=$.red,d=$.green,g=$.blue),O&&(p=parseInt(O.hue,10),p+=p<0?360:0,m=c(O.saturation),y=c(O.lightness)),M=$.opacity||c(v.opacity)}function APCA(e,t){var n,r;function u(e){var t=new Color(e);t.LINEAR_MODIFIER={red:.2126729,green:.7151522,blue:.072175},n=t.isColorType(e)?t:n,h()}function i(e){var t=new Color(e);t.LINEAR_MODIFIER={red:.2126729,green:.7151522,blue:.072175},r=t.isColorType(e)?t:r,h()}var o={threshold:.022,exponent:1.414},a={"12px":[null,null,null,100,94,87,80,80,80],"14px":[null,null,null,90,84,77,70,70,70],"16px":[null,null,110,80,77,72,60,60,60],"18px":[null,null,100,78,74,70,59,59,59],"20px":[null,120,94,76,72,67,58,58,58],"22px":[null,110,87,75,70,65,57,57,57],"24px":[null,100,80,74,66,60,56,56,56],"26px":[null,96,78,72,65,59,55,55,55],"28px":[null,92,76,70,64,58,54,54,52],"30px":[null,88,74,68,62,57,53,52,50],"32px":[null,84,72,66,60,56,52,50,48],"36px":[120,80,70,64,58,54,50,48,46],"40px":[114,77,68,62,57,52,48,46,44],"44px":[108,74,66,60,55,50,46,44,42],"48px":[100,70,65,58,53,48,44,42,40],"56px":[95,67,64,56,51,46,42,40,40],"64px":[90,65,62,54,49,44,40,40,40],"72px":[85,63,60,52,47,42,40,40,40],"96px":[80,60,55,50,45,40,40,40,40]};Object.defineProperty(a,"list",{enumerable:!1,value:function(){return Object.keys(this)}}),Object.defineProperty(a,"toHtml",{enumerable:!1,value:function(){var e=document.createElement("table"),t=document.createElement("thead"),n=document.createElement("tbody"),r=Object.keys(this).reduce((e,t)=>Math.max(e,this[t].length),0),u=t.insertRow(),i=u.appendChild(document.createElement("th")),o=100,a=c();e.appendChild(t),e.appendChild(n),i.innerHTML="Font Size";for(var s=0;s<r;s+=1)(i=u.appendChild(document.createElement("th"))).innerHTML=o,o+=100;return Object.keys(this).forEach(e=>{var t=n.insertRow(),r=this[e];(i=t.insertCell()).innerHTML=e;for(var u=0;u<r.length;u+=1){var o=Number(this[e][u])<=Math.abs(a)?"strong":"span";(i=t.insertCell()).appendChild(document.createElement(o)).innerHTML=this[e][u]||"âŠ˜"}}),e}});var s={normal:{background:.56,foreground:.57,lowThreshold:.035991,lowFactor:27.7847239587675,lowOffset:.027},reverse:{background:.62,foreground:.65,lowThreshold:.035991,lowFactor:27.7847239587675,lowOffset:.027}},l=3;function h(){if(n&&r&&r.opacity<1){var e=n,t=r,u=t.opacity;i(["red","green","blue"].reduce(function(n,r){return n[r]=Math.round(u*t[r]+(1-u)*e[r]),n},{opacity:1}))}}function f(e){return console.log(`ytxt: ${e}, blkThrs: ${o.threshold}; blkcmlp: ${o.exponent}`),e>o.threshold?e:e+Math.pow(o.threshold-e,o.exponent)}function c(){var e,t=n.brightness,u=r.brightness,i=!(t>u),o=s.normal;return console.log(`\nbrightness fore: ${u}\nbrightness back: ${t}\nlightness fore: ${f(u)}\nlightness back: ${f(t)}\n`),u=i?u:f(u),t=i?f(t):t,console.log(`\nfore: ${u}\nback: ${t}\n`),o=i?s.reverse:s.normal,e=1.14*(Math.pow(t,o.background)-Math.pow(u,o.foreground)),(100*(i?e>-.001?0:e>-o.lowThreshold?e-e*o.lowFactor*o.lowOffset:e+o.lowOffset:e<.001?0:e<o.lowThreshold?e-e*o.lowFactor*o.lowOffset:e-o.lowOffset)).toFixed(l)}return Object.defineProperty(this,"Darkness",{enumerable:!0,value:o}),Object.defineProperty(this,"background",{enumerable:!0,get:function(){return n},set:u}),Object.defineProperty(this,"Fonts",{enumerable:!0,value:a}),Object.defineProperty(this,"foreground",{enumerable:!0,get:function(){return r},set:i}),Object.defineProperty(this,"precision",{enumerable:!0,value:l}),Object.defineProperty(this,"PowerCurve",{enumerable:!0,value:s}),Object.defineProperty(this,"score",{enumerable:!1,value:c}),e&&e.background?u(e.background):u(t),e&&e.foreground?i(e.foreground):i(e),this}
